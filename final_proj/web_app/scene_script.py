

# script = [{'id': 0, 'seek': 0, 'start': 0.0, 'end': 6.0, 'text': ' 그래서 오늘 목요일에 특별한 손님으로 윤여정 씨를 모셨습니다.', 'tokens': [50364, 8844, 8880, 20433, 1495, 6403, 1517, 48735, 3049, 15268, 9466, 4130, 36844, 10558, 6170, 13479, 3891, 2429, 11722, 15650, 3115, 13, 50664], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 1, 'seek': 0, 'start': 6.0, 'end': 7.0, 'text': ' 어서 오십시오.', 'tokens': [50664, 2417, 4555, 5175, 32061, 3833, 8920, 13, 50714], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 2, 'seek': 0, 'start': 7.0, 'end': 8.0, 'text': ' 안녕하세요.', 'tokens': [50714, 19289, 13, 50764], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 3, 'seek': 0, 'start': 8.0, 'end': 9.0, 'text': ' 반갑습니다.', 'tokens': [50764, 16396, 27358, 3115, 13, 50814], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 4, 'seek': 0, 'start': 9.0, 'end': 10.0, 'text': ' 네 정말 반갑습니다.', 'tokens': [50814, 8808, 12793, 16396, 27358, 3115, 13, 50864], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 1'}, {'id': 5, 'seek': 0, 'start': 10.0, 'end': 14.0, 'text': ' 저기 호칭 가지고 제가 약간 고민을 했는데요.', 'tokens': [50864, 33789, 26932, 4741, 255, 21361, 7439, 14466, 41936, 1638, 8154, 14586, 13, 51064], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 1'}, {'id': 6, 'seek': 0, 'start': 14.0, 'end': 23.0, 'text': ' 대개 이제 연배가 그렇게 되시면 윤 선생님 이렇게 부르곤 하는데 불러드리곤 하는데', 'tokens': [51064, 5971, 11597, 8424, 34902, 30141, 1453, 16104, 5514, 19722, 36844, 37974, 5483, 10201, 9956, 1155, 97, 29600, 25746, 7871, 6300, 2250, 1155, 97, 29600, 51514], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 7, 'seek': 0, 'start': 23.0, 'end': 24.0, 'text': ' 안 그러셔도 돼요.', 'tokens': [51514, 4811, 14019, 6961, 40720, 21565, 13, 51564], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 2'}, {'id': 8, 'seek': 0, 'start': 24.0, 'end': 28.0, 'text': ' 백분하니까 그런 호칭이 도저히 안 나올 것 같습니다.', 'tokens': [51564, 20710, 15937, 2240, 5690, 9306, 26932, 4741, 255, 1129, 10701, 11738, 5905, 4811, 49599, 4431, 31297, 13, 51764], 'temperature': 0.0, 'avg_logprob': -0.29092945772058826, 'compression_ratio': 1.5347222222222223, 'no_speech_prob': 0.002757112728431821, 'speaker': 'SPEAKER 1'}, {'id': 9, 'seek': 2800, 'start': 28.0, 'end': 32.0, 'text': ' 아니 그건 아니고 호칭이 우리가 굉장히 과하게 됐죠.', 'tokens': [50364, 5651, 41058, 32510, 26932, 4741, 255, 1129, 22408, 15509, 17590, 8601, 16718, 5837, 13, 50564], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 10, 'seek': 2800, 'start': 32.0, 'end': 33.0, 'text': ' 언젠가부터.', 'tokens': [50564, 16738, 2179, 254, 16955, 12130, 13, 50614], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 11, 'seek': 2800, 'start': 33.0, 'end': 34.0, 'text': ' 그렇죠.', 'tokens': [50614, 34410, 13, 50664], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 12, 'seek': 2800, 'start': 34.0, 'end': 38.0, 'text': ' 저희들도 배우끼리 그냥 선배님씨 뭐 그랬었어요.', 'tokens': [50664, 4841, 9428, 1698, 46313, 14155, 22471, 223, 1870, 2250, 11208, 49122, 9466, 25416, 7034, 36185, 22415, 13, 50864], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 13, 'seek': 2800, 'start': 38.0, 'end': 45.0, 'text': ' 그런데 요즘에는 다 막 선생님 이렇게 돼서 어떤 사람들은 또 막 싫어하는 사람들도 있어요.', 'tokens': [50864, 16610, 24835, 11357, 4279, 14438, 37974, 5483, 11080, 2393, 15620, 18078, 22571, 7992, 14438, 33649, 3103, 7116, 39570, 3744, 12654, 13, 51214], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 14, 'seek': 2800, 'start': 45.0, 'end': 50.0, 'text': ' 뭐 가르친 게 있나 저 사람을 우리가 선생님이라고 불러야 되나 그래서 저는 괜찮아요.', 'tokens': [51214, 7034, 10583, 41390, 117, 250, 7845, 48178, 4841, 12211, 1638, 22408, 37974, 20438, 25746, 6235, 4248, 20603, 3404, 8844, 10551, 18286, 5601, 13, 51464], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 15, 'seek': 2800, 'start': 50.0, 'end': 56.0, 'text': ' 그냥 존경의 염으로 그렇게 불러드리는데 두 가지 이유가 있는 것 같습니다.', 'tokens': [51464, 11208, 22116, 112, 15608, 2785, 2087, 120, 4130, 16104, 25746, 7871, 6300, 2250, 4189, 11915, 26569, 32292, 1453, 7153, 4431, 31297, 13, 51764], 'temperature': 0.0, 'avg_logprob': -0.21378974284022306, 'compression_ratio': 1.5794392523364487, 'no_speech_prob': 0.01450196374207735, 'speaker': 'SPEAKER 1'}, {'id': 16, 'seek': 5600, 'start': 56.0, 'end': 60.0, 'text': ' 우선은 이렇게 배우니까 전혀 그 호칭이 안 어울리시는 것 같고요.', 'tokens': [50364, 14995, 12421, 2124, 5483, 14155, 7812, 5690, 6831, 23683, 4296, 26932, 4741, 255, 1129, 4811, 27755, 14981, 18147, 4431, 4385, 12364, 13, 50564], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 17, 'seek': 5600, 'start': 60.0, 'end': 61.0, 'text': ' 젊어 보여요.', 'tokens': [50564, 1647, 232, 3103, 21918, 1495, 13, 50614], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 2'}, {'id': 18, 'seek': 5600, 'start': 61.0, 'end': 62.0, 'text': ' 네.', 'tokens': [50614, 8808, 13, 50664], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 2'}, {'id': 19, 'seek': 5600, 'start': 62.0, 'end': 72.0, 'text': ' 그리고 또 하나는 대개 그런 호칭을 받으시면 이제 좀 어떤 현역에서 좀 이렇게 한 걸음 물러서서 뒷방에 계신 듯한 그런 느낌이 드는데.', 'tokens': [50664, 8785, 7992, 12261, 1098, 5971, 11597, 9306, 26932, 4741, 255, 1638, 12152, 10307, 19722, 8424, 6796, 15620, 17505, 18015, 4885, 6796, 5483, 4815, 14240, 5654, 26561, 6235, 2393, 2393, 14749, 115, 27630, 1517, 10603, 7575, 43058, 3049, 9306, 29459, 35561, 4189, 13, 51164], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 20, 'seek': 5600, 'start': 72.0, 'end': 73.0, 'text': ' 아 그래요.', 'tokens': [51164, 2216, 47453, 13, 51214], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 2'}, {'id': 21, 'seek': 5600, 'start': 73.0, 'end': 78.0, 'text': ' 네 늘 이렇게 현역에서 너무 열심히 활동하고 계시기 때문에 그냥 윤여정 씨로.', 'tokens': [51214, 8808, 33684, 5483, 17505, 18015, 4885, 6924, 31939, 45638, 7040, 10603, 3833, 2401, 12365, 11208, 36844, 10558, 6170, 13479, 3891, 1955, 13, 51464], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 2'}, {'id': 22, 'seek': 5600, 'start': 78.0, 'end': 80.0, 'text': ' 네 저도 괜찮습니다.', 'tokens': [51464, 8808, 27591, 18286, 3115, 13, 51564], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 23, 'seek': 5600, 'start': 80.0, 'end': 82.0, 'text': ' 저도 손석희 씨로 불러도 되죠.', 'tokens': [51564, 27591, 15268, 17075, 11975, 13479, 3891, 1955, 25746, 7871, 1838, 5514, 5837, 13, 51664], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 24, 'seek': 5600, 'start': 82.0, 'end': 83.0, 'text': ' 당연하죠.', 'tokens': [51664, 43424, 48967, 13, 51714], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 25, 'seek': 5600, 'start': 83.0, 'end': 85.0, 'text': ' 저보다 물론 아래시죠.', 'tokens': [51714, 13163, 27655, 41251, 9200, 4241, 37822, 13, 51814], 'temperature': 0.0, 'avg_logprob': -0.20397862285172857, 'compression_ratio': 1.5838323353293413, 'no_speech_prob': 0.5616220831871033, 'speaker': 'SPEAKER 1'}, {'id': 26, 'seek': 8500, 'start': 86.0, 'end': 88.0, 'text': ' 반갑습니다. 이렇게 스튜디오에서 뵙습니다.', 'tokens': [50414, 16396, 27358, 3115, 13, 5483, 11196, 232, 2163, 49117, 4885, 531, 113, 247, 3115, 13, 50514], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 27, 'seek': 8500, 'start': 88.0, 'end': 89.0, 'text': ' 저도 너무 반가워요.', 'tokens': [50514, 27591, 6924, 16396, 1453, 35837, 13, 50564], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 28, 'seek': 8500, 'start': 89.0, 'end': 94.0, 'text': ' 제가 정말 거짓말 아니고 이 JTBC 뉴스 팬이에요.', 'tokens': [50564, 7439, 12793, 3675, 1372, 241, 11023, 32510, 2620, 508, 51, 7869, 45828, 45480, 15099, 13, 50814], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 29, 'seek': 8500, 'start': 94.0, 'end': 95.0, 'text': ' 손석희 씨 팬이에요.', 'tokens': [50814, 15268, 17075, 11975, 17394, 45480, 15099, 13, 50864], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 30, 'seek': 8500, 'start': 95.0, 'end': 96.0, 'text': ' 진짜로.', 'tokens': [50864, 5526, 1372, 15636, 13, 50914], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 31, 'seek': 8500, 'start': 96.0, 'end': 99.0, 'text': ' 그래서 어떤 사람이 따지기까지 했어요.', 'tokens': [50914, 8844, 15620, 27660, 49150, 1831, 2401, 8786, 36331, 13, 51064], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 32, 'seek': 8500, 'start': 99.0, 'end': 101.0, 'text': ' 그 남자 왜 이렇게 좋아하냐고.', 'tokens': [51064, 4296, 35266, 9883, 5483, 10805, 8037, 12476, 1313, 13, 51164], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 33, 'seek': 8500, 'start': 101.0, 'end': 105.0, 'text': ' 그래서 아까 제가 처음에 뵀을 때 막 얼굴이 빨개지고 당황해지고 그랬어요.', 'tokens': [51164, 8844, 25289, 7439, 18736, 1517, 531, 113, 25700, 7765, 14438, 30818, 1129, 46954, 11597, 11213, 12047, 19244, 7002, 11061, 1313, 36185, 4213, 13, 51364], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 34, 'seek': 8500, 'start': 105.0, 'end': 107.0, 'text': ' 정말 오래간만에 한 경험입니다.', 'tokens': [51364, 12793, 46211, 1126, 2703, 6478, 1517, 4815, 9537, 24651, 7416, 13, 51464], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}, {'id': 35, 'seek': 8500, 'start': 107.0, 'end': 108.0, 'text': ' 고맙습니다.', 'tokens': [51464, 9161, 3468, 247, 3115, 13, 51514], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 2'}, {'id': 36, 'seek': 8500, 'start': 108.0, 'end': 109.0, 'text': ' 고맙습니다.', 'tokens': [51514, 9161, 3468, 247, 3115, 13, 51564], 'temperature': 0.0, 'avg_logprob': -0.15164207689689868, 'compression_ratio': 1.6124567474048443, 'no_speech_prob': 0.025559403002262115, 'speaker': 'SPEAKER 1'}]

# timeline = [{'start': 0.162, 'end': 18.950},
#  {'start': 39.018, 'end': 47.824},
#  {'start': 54.223, 'end': 77.465},
#  {'start': 99.496, 'end': 234.803},
# ]


def get_scene_script(script, timeline):


    ret = []
    id = 0
    for t in timeline:

      start = t['start']
      end = t['end']
      s = ''      

      max_time_s = int(script[-1]['start'])
      max_time_e = int(script[-1]['end'])


      if not start :
        start_k = 0
      else :
        k = 0
        while start > int(script[k]['start']) and int(script[k]['start']) != max_time_s :
          k += 1
        start_k = k

      if not end :
        end_k = len(script) -1
      else :
        k = 0
        while end > int(script[k]['end']) and int(script[k]['end']) != max_time_e :
          k += 1
        end_k = k


      for i in range(start_k, end_k + 1) :
        s += script[i]['text']
 
      ret.append({'tid': id, 'start':start, 'end': end, 'text': s})
      id += 1


    return ret
    

scene_script = [{'tid': 0, 'start': 0.162, 'end': 18.95, 'text': ' 네 우리 친구들 시간 좀 걸리니까 빨리 빨리 자리 잡으실게요. 네. 아 네 인사 나중에 하시고요. 형 졸린다. 너 청첩장 모바일로 받았냐? 나도 모바일로 받았어. 그럼 수용이 형 얼마 했냐? 나 5. 아 나 10 했는데. 너 왜 이렇게 많이 했어? 10은 해야지. 너네 둘이 그 정도 사이 아닌 거 같은데? 아 10은.. 야 너 식권 받았냐? 아 식권? 아 씨.. 상관없어 밑에 가서 그냥 적고 들어가면 돼. 근데 용준이 어디 갔냐? 용준이 밥 먹으러 갔어.'}, {'tid': 1, 'start': 39.018, 'end': 47.824, 'text': ' 아 그 새끼 사인실 때 전화 달라고 그랬는데. 됐어 그냥 찍어. 아 이 새끼 졸라 안 되겠네. 야 너 결혼식 올 때 면도 좀 하고 오지 좀. 면도 한 거야. 구라치지 마. 야야 미진이 미진이. 미진이랑 인사했냐? 아 씨 인사를 어떻게 해. 미진아! 하지 마 하지 마 하지 마. 진서연 인사했어. 하지 마! 형 안녕. 어. 왔어? 아 이 새끼 왜 이렇게 졸라 빨리 왔어. 빨리 자리 잡어. 아 씨 남자친구랑 같이 왔잖아. 아 씨.. 어디? 저기 가방 쪽에 있잖아. 저기 기다리고 있잖아. 미진이 맨날 더 큰 애만 만났네.'}, {'tid': 2, 'start': 54.223, 'end': 77.465, 'text': ' 뒤에 남성 분자 한 칸만 올라가실게요. 안경 쓰신 분. 머리 포마드 하신 분. 아 지금 고개 돌리신 분. 네네. 네 감사합니다. 좋습니다. 아 씨.. 나 못 알아들어 왜? 뒤에 남성 분들 지금 안 보이십니다. 친구분들 머리 사이사이에 설게요. 지금 오신 분들 신랑 신부 구분 짓지 말고 이쪽으로 넘어가 주실게요. 네네네. 야 왜 이렇게 늦게 다녀? 빨리 빨리 와줘. 네 감사합니다. 네. 야 근데 신부 쪽 사람 왜 이렇게 없냐? 신부 회사 사람 다 코로나 걸렸대. 아 나 결혼할 때 코로나 진짜 없어야 되는데. 너 결혼 못해? 못하는 게 아니라 안 하는 거야. 너 연애 언제 했니? 5년 전이라서 안 했지. 찍겠습니다. 네 그리고 우리 친구분들 안경 쓰신 분들 안경 살짝 올려 쓰세요. 너? 너 올리라고? 아 좀 빨리 좀 찍지. 자 우리 남성분들 조금만 더 웃으실게요. 단체로 뭐 안 좋은 일 있으세요?'}, {'tid': 3, 'start': 99.496, 'end': 234.803, 'text': ' 아 왜 자꾸 웃어? 아 웃는 거 왜 이렇게 어색하냐? 아 좋습니다. 자 갈게요. 하나 둘. 자 한 번 더 찍겠습니다. 손 차렷하실게요. 후회하지 마시고. 하나 둘. 오케이. 사진 줄라고? 자 이번엔 부캐 받으시는 분. 네 앞으로 나와주세요. 야 쟤 해적이 아니야? 해적이? 걔 있잖아. 고등학교 때 빨래 잘못해서 맨날 옷에서 냄새나서. 걔야? 와 쟤 살 진짜 많이 뺐다. 쟤 옛날에 나 좋아했었는데. 개소리하지 마. 자 하나 둘 셋 하면 부캐 던질게요. 자 친구분들 박수. 자 찍겠습니다. 하나 둘 셋. 저거 어색해 던지다. 아 저게 어려운가? 아 우리 신부님. 집중하는 건 좋은데 너무 얼굴이 경직돼 있다. 포물선 그리면서 다시 한 번 던져볼게요. 아 빨리 좀 찍지 좀. '}]


from kiwipiepy import Kiwi

import torch
from transformers import PreTrainedTokenizerFast, BartForConditionalGeneration


device = torch.device("cuda" if torch.cuda.is_available() else "cpu")
tokenizer = PreTrainedTokenizerFast.from_pretrained('gogamza/kobart-summarization')
model = BartForConditionalGeneration.from_pretrained('gogamza/kobart-summarization')
model = model.to(device)

kiwi = Kiwi()

def get_scene_summary(scene_script):
    """
    text : 요약을 원하는 text
    k : 하나로 뭉칠 segment 갯수
    output : (요약문 -> list)
    """
      
    ret = scene_script

    
    
    for idx, seg in enumerate(scene_script):
      text = seg['text']
      summ = ""
      for i, sent in enumerate(kiwi.split_into_sents(text)):
      # print(sent)

        sent = sent.text
        summ += sent
      raw_input_ids = tokenizer.encode(summ)
      input_ids = [tokenizer.bos_token_id] + raw_input_ids + [tokenizer.eos_token_id]

      inputs = torch.tensor([input_ids])
      inputs = inputs.to(device)

      # summary_ids = model.generate(inputs,  max_new_tokens=100)

      summary_ids = model.generate(inputs,  max_new_tokens=100)
      output = tokenizer.decode(summary_ids.squeeze().tolist(), skip_special_tokens=True)



      ret[idx]['summ_text'] = output
    

    return ret

k = get_scene_summary(scene_script)
print(k)